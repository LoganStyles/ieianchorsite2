!function(y){"use strict";y.fn.lightspeedBox=function(t){function i(t){void 0!==t&&(t.stopPropagation(),v.autoPlayback=!1),1<w.images.length?o(w.nextImage()):s()}function s(){n.removeClass("lsb-active"),c.removeClass("lsb-image-loaded"),c.addClass("lsb-noimage"),f=!0}function a(){v.autoPlayback&&i(),v.autoPlayback&&!f&&window.setTimeout(a,v.playbackTiming)}function o(t){c.addClass("lsb-noimage"),c.removeClass("lsb-image-loaded"),r.addClass("lsb-image-notitle"),d.hide(),window.setTimeout(function(){!function(e){l.show(),u.text(v.showImageCount&&1<w.images.length?w.current+1+"/"+w.images.length:"");var t=y("<img />").attr("src",e.href).on("load",function(){c.attr("src",t.attr("src")),v.showImageTitle&&r.text(e.alt),m.attr("href",e.href),l.hide(),c.removeClass("lsb-noimage"),c.addClass("lsb-image-loaded"),r.removeClass("lsb-image-notitle")}).on("error",function(t){l.hide(),r.text(e.alt),d.show(),console.log("[LSB Error]:",t)})}(t)},e)}var n,l,c,r,u,d,g,h,b,m,p,v=y.extend({showImageTitle:!0,showImageCount:!0,showDownloadButton:!0,showAutoPlayButton:!0,autoPlayback:!1,playbackTiming:3500,zIndex:30,locale:{nextButton:"Next image",prevButton:"Previous image",closeButton:"Close",downloadButton:"Download image",noImageFound:"Sorry, no image found.",autoplayButton:"Enable autoplay"}},t),e=400,f=!0,w={current:null,images:[],getImagesInSet:function(t){var a=[],o=0,n=t.attr("href"),e=t.find("img").attr("alt"),i=t.attr("data-lsb-group");i?y('.lsb-preview[data-lsb-group="'+i+'"]').each(function(t,e){var i=e.getAttribute("href"),s=y(e).find("img").attr("alt");a.push({href:i,alt:s}),i===n&&(o=t)}):a.push({href:n,alt:e}),this.images=a,this.current=o,1===this.images.length?(h.css("visibility","hidden"),g.css("visibility","hidden"),p.hide()):(h.css("visibility","visible"),g.css("visibility","visible"),v.showAutoPlayButton&&p.show())},nextImage:function(){return 0===this.images.length?"":(this.current+=1,this.current>this.images.length-1&&(this.current=0),this.images[this.current])},previousImage:function(){return 0===this.images.length?"":(this.current-=1,this.current<0&&(this.current=this.images.length-1),this.images[this.current])},canSwitch:function(){return 1<this.images.length}};!function(){for(var t="",e=0;e<12;e++)t+='<div class="waitingicon-circle"></div>';y("body").append('<div class="lightspeed-box"><div class="lsb-content"><header class="lsb-header"><div class="lsb-image-count"></div><div class="lsb-image-title"></div></header><div class="lsb-control-panel"><a class="lsb-control lsb-panel-button lsb-autoplay" title="Slideshow">►</a><a class="lsb-control lsb-panel-button lsb-download" download title="Download Image">&#8681;</a></div><div class="lsb-image-container"><div class="lsb-no-image-found"><div class="no-found-msg">Sorry, no image found.</div></div><img class="lsb-image lsb-noimage"></div><div class="waitingicon">'+t+'</div><div class="lsb-control lsb-close"><span class="lsb-control-text" title="Close the image">&#x2716;</span></div><div class="lsb-control lsb-prev"><span class="lsb-control-text" title="Next image">&lt;</span></div><div class="lsb-control lsb-next"><span class="lsb-control-text" title="Previous image">&gt;</span></div></div></div>'),(n=y(".lightspeed-box")).css("z-index",v.zIndex),l=y(".waitingicon"),c=n.find(".lsb-image"),r=n.find(".lsb-image-title"),u=n.find(".lsb-image-count"),d=n.find(".lsb-no-image-found"),g=n.find(".lsb-next"),h=n.find(".lsb-prev"),b=n.find(".lsb-close"),m=n.find(".lsb-download"),p=n.find(".lsb-autoplay"),v.showDownloadButton||m.hide(),v.showAutoPlayButton||p.hide(),g.attr("title",v.locale.nextButton),h.attr("title",v.locale.prevButton),b.attr("title",v.locale.closeButton),m.attr("title",v.locale.downloadButton),d.find(".no-found-msg").text(v.locale.noImageFound),n.swipeDetector().on("swipeLeft.lsb swipeRight.lsb",function(t){1<w.images.length&&("swipeLeft"===t.type?o(w.nextImage()):"swipeRight"===t.type&&o(w.previousImage()))}),y(document).on("keyup.lightspeed-box",function(t){n.hasClass("lsb-active")&&(39===t.which&&1<w.images.length?(t.stopPropagation(),o(w.nextImage())):37===t.which&&1<w.images.length?(t.stopPropagation(),o(w.previousImage())):27===t.which&&s())}),g.click(function(t){t.stopPropagation(),v.autoPlayback=!1,o(w.nextImage())}),h.click(function(t){t.stopPropagation(),v.autoPlayback=!1,o(w.previousImage())}),p.click(function(t){t.stopPropagation(),v.autoPlayback=!v.autoPlayback,v.autoPlayback?(p.text("| |"),p.removeClass("lsb-autoplay"),p.addClass("lsb-autoplay-playing"),window.setTimeout(a,v.playbackTiming)):(p.text("►"),p.removeClass("lsb-autoplay-playing "),p.addClass("lsb-autoplay"))}),m.click(function(t){t.stopPropagation()}),d.click(i),c.click(i),n.click(function(){v.autoPlayback=!1,s()}),r.click(function(t){t.stopPropagation()})}(),y(".lsb-preview").click(function(t){t.preventDefault(),w.getImagesInSet(y(this)),f=!1,u.text(""),n.addClass("lsb-active"),o(w.images[w.current]),v.autoPlayback&&window.setTimeout(a,v.playbackTiming)})},y.fn.swipeDetector=function(s){function t(t){(!s.useOnlyTouch||t.originalEvent.touches)&&(t.originalEvent.touches&&(t=t.originalEvent.touches[0]),0===a&&(a=1,o=t.clientX,n=t.clientY))}function e(){2===a&&(a=0,Math.abs(l)>Math.abs(c)&&Math.abs(l)>s.swipeThreshold?r.trigger(l<0?y.Event("swipeLeft.lsb"):y.Event("swipeRight.lsb")):Math.abs(c)>s.swipeThreshold&&r.trigger(c<0?y.Event("swipeUp.lsb"):y.Event("swipeDown.lsb")))}function i(t){if(1===a){t.originalEvent.touches&&(t=t.originalEvent.touches[0]);var e=t.clientX-o,i=t.clientY-n;(Math.abs(e)>s.swipeThreshold||Math.abs(i)>s.swipeThreshold)&&(a=2,l=e,c=i)}}var a=0,o=0,n=0,l=0,c=0,r=this,u={swipeThreshold:70,useOnlyTouch:!0};return s=y.extend(u,s),r.on("mousedown touchstart",t),y("html").on("mouseup touchend",e),y("html").on("mousemove touchmove",i),r}}(jQuery);